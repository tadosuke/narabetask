<!DOCTYPE html>
<html>
<head>
    <title>Test Horizontal Tasks</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .pass { background-color: #e7f5e7; border-color: #5cb85c; }
        .fail { background-color: #f5e7e7; border-color: #d9534f; }
    </style>
</head>
<body>
    <h1>Test: Horizontal Task Display Logic</h1>
    
    <div id="results"></div>

    <script type="module">
        // Simple test functions to verify work time collision logic
        
        function timeToMinutes(time) {
            const [hours, minutes] = time.split(":").map(Number);
            return hours * 60 + minutes;
        }

        function minutesToTime(minutes) {
            const hours = Math.floor(minutes / 60);
            const mins = minutes % 60;
            return `${hours.toString().padStart(2, "0")}:${mins.toString().padStart(2, "0")}`;
        }

        function getWorkTimeSlots(startTime, duration, workTime, waitTime) {
            const actualWaitTime = waitTime ?? 0;
            const actualWorkTime = workTime ?? (duration - actualWaitTime);
            
            const slots = [];
            const startMinutes = timeToMinutes(startTime);

            for (let i = 0; i < actualWorkTime; i += 15) {
                slots.push(minutesToTime(startMinutes + i));
            }

            return slots;
        }

        function runTest(name, task1, task2, expected) {
            const startTime = "09:00";
            
            const task1WorkSlots = getWorkTimeSlots(
                startTime, 
                task1.duration, 
                task1.workTime, 
                task1.waitTime
            );
            
            const task2WorkSlots = getWorkTimeSlots(
                startTime, 
                task2.duration, 
                task2.workTime, 
                task2.waitTime
            );
            
            const hasWorkTimeOverlap = task1WorkSlots.some(slot => task2WorkSlots.includes(slot));
            const canCoexist = !hasWorkTimeOverlap;
            
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${canCoexist === expected ? 'pass' : 'fail'}`;
            resultDiv.innerHTML = `
                <h3>${name}</h3>
                <p><strong>Task 1:</strong> duration=${task1.duration}, work=${task1.workTime}, wait=${task1.waitTime}</p>
                <p><strong>Task 1 work slots:</strong> [${task1WorkSlots.join(', ')}]</p>
                <p><strong>Task 2:</strong> duration=${task2.duration}, work=${task2.workTime}, wait=${task2.waitTime}</p>
                <p><strong>Task 2 work slots:</strong> [${task2WorkSlots.join(', ')}]</p>
                <p><strong>Can coexist:</strong> ${canCoexist} (expected: ${expected})</p>
                <p><strong>Result:</strong> ${canCoexist === expected ? 'PASS' : 'FAIL'}</p>
            `;
            document.getElementById('results').appendChild(resultDiv);
        }

        // Test cases
        runTest(
            "Default tasks (both all work time)",
            { duration: 30 }, // workTime: 30, waitTime: 0
            { duration: 30 }, // workTime: 30, waitTime: 0
            false // Should NOT be able to coexist
        );

        runTest(
            "Work task + Wait task",
            { duration: 30, workTime: 30, waitTime: 0 }, // All work
            { duration: 30, workTime: 0, waitTime: 30 }, // All wait
            true // Should be able to coexist
        );

        runTest(
            "Staggered work times",
            { duration: 30, workTime: 15, waitTime: 15 }, // Work: 09:00-09:15, Wait: 09:15-09:30
            { duration: 30, workTime: 15, waitTime: 0 }, // Work: 09:00-09:15, then done
            false // Should NOT coexist (both work 09:00-09:15)
        );

        runTest(
            "Complementary work/wait times",
            { duration: 30, workTime: 15, waitTime: 15 }, // Work: 09:00-09:15, Wait: 09:15-09:30
            { duration: 30, workTime: 0, waitTime: 30 }, // Wait: 09:00-09:30
            true // Should coexist (first has work 09:00-09:15, second has no work)
        );

    </script>
</body>
</html>